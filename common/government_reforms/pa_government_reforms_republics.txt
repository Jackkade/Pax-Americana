#Beyond Typus Note -
#Unfortunately, it appears there is no way to modify the new gov system without overriding it, an odd and somewhat disappointing choice of Paradox's end, to be honest.
#I'll try to document the file well and keep things as organised as possible, but any submods or addons wanting to add their own content will be forced to update 
#fresh each BT update as far as I can tell, sadly. I'm afraid the matter appears to be completely out of my hands, but if you have a suggestion to improve cross compatibility, please do share.
# -This file contains new reforms at the bottom.

#Articles of Confederation
congress_of_confederation_reform = {
	icon = "articles_confederation"
	allow_normal_conversion = no
	lock_level_when_selected = yes
	potential = {
		OR = {
			AND = {
				tag = USA
				NOT = { map_setup = map_setup_random }
			}
			AND = {
				is_playing_custom_nation = yes
				have_had_reform = congress_of_confederation_reform
			}
		}
		NOT = {
			OR = {
				have_had_reform = american_republic
				have_had_reform = federal_republic
			}
		}
	}
	valid_for_nation_designer = yes
	nation_designer_cost = 15
	nation_designer_trigger = {
		has_dlc = "American Dream"
	}
	legacy_equivalent = american_republic_legacy
	modifiers = {
		global_autonomy = -0.03
		republican_tradition = -0.5 
		max_absolutism = -25
	}

	custom_attributes = {
		enables_plutocratic_idea_group = yes
		enables_aristocratic_idea_group = no
		max_possible_parliament_seats = 13
	}
	conditional = {
		allow = {
			OR = {
				has_dlc = "Common Sense"
				has_dlc = "Domination"
			}
		}
		has_parliament = yes
		custom_attributes = {
			blocked_call_diet = yes
			english_parliament = yes
		}
	}
	duration = 2
	ai = {
		factor = 1000
	}

}

#Alt-History republic? maybe jeffersonian? unsure what do with it currently
american_republic = {
	icon = "parliament"
	allow_normal_conversion = yes
	lock_level_when_selected = yes
	potential = {
		always = no #TODO find better use for this reform
		OR = {
			AND = {
				OR = {
					tag = USA
					primary_culture = american
				}
				NOT = { map_setup = map_setup_random }
			}
			AND = {
				is_playing_custom_nation = yes
				have_had_reform = american_republic
			}
		}
	}
	valid_for_nation_designer = yes
	nation_designer_cost = 15
	nation_designer_trigger = {
		has_dlc = "American Dream"
	}
	legacy_equivalent = american_republic_legacy
	modifiers = {
		war_exhaustion = -0.04
		stability_cost_modifier = -0.15
		governing_capacity = 20
		max_absolutism = 35
		max_terms = 4
	}
	custom_attributes = {
		enables_plutocratic_idea_group = yes
		enables_aristocratic_idea_group = no
		has_limited_terms = yes
		has_candidate_bonus = yes
		max_possible_parliament_seats = 13
	}
	conditional = {
		allow = {
			OR = {
				has_dlc = "Common Sense"
				has_dlc = "Domination"
			}
		}
		has_parliament = yes
		custom_attributes = {
			blocked_call_diet = yes
			english_parliament = yes
		}
	}
	duration = 4
}

#IRL US constitution
federal_republic = {
	icon = "constitution"
	allow_normal_conversion = yes
	lock_level_when_selected = yes
	potential = {
		OR = {
			AND = {
				tag = USA
				NOT = { map_setup = map_setup_random }
			}
			AND = {
				is_playing_custom_nation = yes
				have_had_reform = federal_republic
			}
		}
	}
	legacy_equivalent = federal_republic_legacy
	valid_for_nation_designer = yes
	nation_designer_cost = 15
	nation_designer_trigger = {
		has_dlc = "American Dream"
	}
	modifiers = {
		expand_administration_cost = -0.1
		candidate_random_bonus = 1
		governing_capacity = 30
		max_absolutism = 10
		max_terms = 2
	}

	custom_attributes = {
		enables_plutocratic_idea_group = yes
		enables_aristocratic_idea_group = no
		has_limited_terms = yes
		has_candidate_bonus = yes
		max_possible_parliament_seats = 13
	}
	conditional = {
		allow = {
			OR = {
				has_dlc = "Common Sense"
				has_dlc = "Domination"
			}
		}
		has_parliament = yes
		custom_attributes = {
			blocked_call_diet = yes
			english_parliament = yes
		}
	}
	duration = 4
}

#New Spain Viceroyalty
colonial_viceroyalty_reform = {
	icon = "crown_colony_government"
	valid_for_nation_designer = no
	lock_level_when_selected = yes
	allow_normal_conversion = no
	fixed_rank = 0
	potential = {
		is_colonial_nation = yes
		OR = {
			has_reform = crown_colony_government
			has_reform = private_enterprise_colony_government
			has_reform = self_governing_colony_government
		}
	}
	trigger = {
		is_subject_of_type = colonial_viceroyalty_pa
	}
	legacy_equivalent = colonial_government_legacy
	modifiers = {		
		army_tradition = 0.5
		missionaries = 1
		nobles_influence_modifier = 0.05
		governing_capacity = 50 # Harb's Autonomy Overhaul
		governing_capacity_modifier = 0.1
		max_absolutism = 55
	}
	effect = {
		hidden_effect = {
			if = {
				limit = { is_subject_of_type = private_enterprise }
				add_government_reform = private_enterprise_colony_government
			}
			if = {
				limit = { is_subject_of_type = self_governing_colony }
				add_government_reform = self_governing_colony_government
			}
		}
	}
	removed_effect = {
		hidden_effect = {
			if = {
				limit = { is_subject_of_type = private_enterprise }
				add_government_reform = private_enterprise_colony_government
			}
			if = {
				limit = { is_subject_of_type = self_governing_colony }
				add_government_reform = self_governing_colony_government
			}
		}
	}

	custom_attributes = {
		locked_government_type = yes
		enables_plutocratic_idea_group = no
		enables_aristocratic_idea_group = yes
		enables_estate_nobles = yes
		enables_estate_burghers = yes
		enables_estate_church = yes
	}
	duration = 8
}

english_parliamentary_republic_government = {
	icon = "house_of_lords"
	lock_level_when_selected = yes
	allow_normal_conversion = no
	potential = {
		has_dlc = "Domination"
		OR = {
			culture_group = british
			culture = anglois
		}
		NOT = {
			culture = american
		}
	}
	nation_designer_cost = 20
	nation_designer_trigger = {
		OR = {
			culture_group = british
			culture = anglois
		}
		NOT = {
			culture = american
		}
	}
	valid_for_nation_designer = yes
	modifiers = {
		num_of_parliament_issues = 1
		republican_tradition = 0.25
		max_absolutism = 5
	}
	duration = 5
	custom_attributes = {
		enables_plutocratic_idea_group = yes
		enables_aristocratic_idea_group = no
	}
	
	conditional = {
		allow = {
			has_dlc = "Common Sense"
			NOT = { has_dlc = "Domination" }
		}
		has_parliament = yes
	}
	conditional = {
		allow = {
			has_dlc = "Domination"
		}
		has_parliament = yes
		custom_attributes = {
			english_parliament = yes
		}
	}
}

bill_of_rights_reform = {
	icon = "constitution"
	allow_normal_conversion = yes
	potential = {
		NOT = {
			has_government_attribute = is_pirate_republic_reform
		}
		tag = USA
	}
	modifiers = {
		global_trade_goods_size_modifier = 0.05
		development_cost_modifier = -0.05
		burghers_loyalty_modifier = 0.10
		burghers_influence_modifier = 0.10
		church_influence_modifier = -0.05
		max_absolutism = -5
	}
	ai = {
		factor = 100
	}
}
american_system_reform = {
	icon = "alexander_hamilton"
	allow_normal_conversion = yes
	potential = {
		NOT = {
			has_government_attribute = is_pirate_republic_reform
		}
		tag = USA
	}
	modifiers = {
		build_cost = -0.1
		mercantilism_cost = -0.1 
		global_own_trade_power = 0.05
		global_prov_trade_power_modifier = 0.05
		global_trade_goods_size_modifier = 0.05
		global_foreign_trade_power = -0.2
	}
	ai = {
		factor = 100
	}
}
public_land_survey_system_reform = {
	icon = "landscape"
	allow_normal_conversion = yes
	potential = {
		NOT = {
			has_government_attribute = is_pirate_republic_reform
		}
		tag = USA
	}
	modifiers = {	#Basically like an extra land right, USA historically had very little 'Crownland'
		colony_development_boost = 1
		expand_administration_cost = -0.15
		global_autonomy = 0.02
		governing_capacity = 10
		governing_capacity_modifier = 0.05
	}
	ai = {
		factor = 100
	}
}
